deny_critical_vulnerabilities[msg] if {
  some vuln in input.vulnerabilities
  some rating in vuln.ratings
  rating.severity == "critical"
  
  some affect in vuln.affects
  affected_ref := affect.ref
  
  some comp in input.components
  comp["bom-ref"] == affected_ref
  
  msg := sprintf("Critical vulnerability found: %s (CVSS: %v) affects %s version: %s - %s", 
    [vuln.id, rating.score, comp.name, comp.version, comp.description])
}